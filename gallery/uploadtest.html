<html>
	<head>
		<title>"AJAX" Upload Test</title>
		
		<script src="./js/jquery-1.3.2.min.js" type="text/javascript"></script>
		<script>
		// global singletons
		var endpoint = 'http://mbp:8322';
		var sourcePath = '/com/gallery/facades/';
		var imageFacade = 'ImageFacade.cfc?callback=?';
		
		$(document).ready(function(){
			var jForm = $('#theForm');
			
			jForm.submit(function(objEvent){
				var jThis = $(this);
				var strName = ('image-uploader' + (new Date()).getTime());
				var jFrame = $('<iframe name="' + strName + '" src="about:blank" />');
				jFrame.css('display','none');
				
				jFrame.load(function(objEvent){
					var objUploadBody = window.frames[ strName ].document.getElementByTagName('body')[ 0 ];
					var jBody = $(objUploadBody);
					var objData = eval( '(' + jBody.html() + ')' );
					prompt( "Return Data:", objData );
					setTimeout(
						function(){
							jFrame.remove();
						},
						100
					);
				});
				
				$('body:first').append(jFrame);
				jThis
					.attr('action',endPoint + sourcePath + imageFacade)
					.attr('method','post')
					.attr('enctype','multipart/form-data')
					.attr('encoding','multipart/form-data')
					.attr('target',strName);
			});
		});
		</script>
	</head>
	<body>
		<form id="theForm">
			<input type="hidden" id="imageID" name="imageID" />
			<input type="hidden" id="method" name="method" value="addImage" />
			<input type="hidden" id="albumID" name="albumID" />
			
			Name: <input type="text" id="newImageName" name="newImageName" size="30" /><br/>
			Desc: <input type="text" id="newImageDesc" name="newImageDesc" size="30" /><br/>
			File: <input type="file" id="theImageFile" name="theImageFile" size="30" /><br/>
			<br/>
			<input type="submit" name="submit" value="Upload" />
		</form>
	</body>
</html>